<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta
            name="viewport"
            content="width=device-width, initial-scale=1.0, viewport-fit=cover"
    />

    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/x-icon" href="icons/smash-logo.ico">
    <meta name="theme-color" content="#3b82f6">
    
    <!-- iOS Support -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="SMASH">
    <link rel="apple-touch-icon" href="icons/smash-logo.png">

    <title>SMASH Game Sign Up</title>
    <link rel="stylesheet" href="style.css" />

    <!-- Firebase SDKs (Compat builds for simple <script> use) -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
</head>
<body>
<header class="topbar">
    <div class="brand">
        <img src="icons/smash-logo.png" alt="SMASH Logo" class="title-icon" />
    </div>
    <h1 class="title-bar">
        SMASH Game SignUp
    </h1>
    <div id="userBox"></div>
</header>

<main class="container">
    <section class="legend">
        <div><span class="pill p0">P0</span> Main Game</div>
        <div><span class="pill p1">P1</span> Fallback Game</div>
        <div>
            <a href="https://www.stthomassfo.org/parish/ministries/smash#h.ud41mji00z5n" class="pill active" target="_blank">
                Guidelines
            </a>
        </div>
    </section>

    <section id="filtersSection" class="filters">
        <div class="filter-group">
            <label for="filterDay">Day</label>
            <select id="filterDay">
                <option value="">All Days</option>
                <option value="0">Sunday</option>
                <option value="1">Monday</option>
                <option value="2">Tuesday</option>
                <option value="3">Wednesday</option>
                <option value="4">Thursday</option>
                <option value="5">Friday</option>
                <option value="6">Saturday</option>
            </select>
        </div>
        <button id="clearFilters" class="filter-clear">Clear Filter</button>
    </section>

    <section id="sportTabs" class="tabs"></section>
    <section id="tabContent" class="tab-content"></section>
</main>

<!-- Guest Modal -->
<div id="guestModal" class="modal">
    <div class="modal-content">
        <span class="modal-close" onclick="closeGuestModal()">&times;</span>
        <h2>Add Guest Player</h2>
        <form id="guestForm" onsubmit="submitGuest(event)">
            <div class="form-group">
                <label for="fullName">Full Name *</label>
                <input type="text" id="fullName" name="fullName" required />
            </div>
            <div class="form-group">
                <label for="parishionerName">Parishioner Name *</label>
                <input type="text" id="parishionerName" name="parishionerName" required readonly />
            </div>
            <div class="form-group">
                <label for="familyId">Family ID *</label>
                <input type="text" id="familyId" name="familyId" required />
            </div>
            <div class="form-actions">
                <button type="button" class="btn" onclick="closeGuestModal()">Cancel</button>
                <button type="submit" class="btn primary">Add Guest</button>
            </div>
        </form>
    </div>
</div>

<!-- Preferences Modal -->
<div id="preferencesModal" class="modal">
    <div class="modal-content">
        <span class="modal-close" onclick="closePreferencesModal()">&times;</span>
        <h2>Sport Preferences</h2>
        <p style="color:#6b7280;font-size:14px;margin-bottom:16px;">Select the sports you want to see in your schedule. If none are selected, all sports will be shown.</p>
        <form id="preferencesForm">
            <div id="sportCheckboxes" class="sport-checkboxes"></div>
            <div class="form-actions">
                <button type="button" class="btn" onclick="closePreferencesModal()">Cancel</button>
                <button type="button" class="btn primary" onclick="savePreferences()">Save Preferences</button>
            </div>
        </form>
    </div>
</div>

<!-- Your Firebase config -->
<script src="firebase-config.js"></script>

<!-- App logic -->
<script src="app.js"></script>

<!-- Service Worker Registration for PWA -->
<script>
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('/sw.js')
      .then((registration) => {
        console.log('ServiceWorker registered:', registration);
      })
      .catch((error) => {
        console.log('ServiceWorker registration failed:', error);
      });
  });
}
</script>

<!-- Optional: run once to seed your schedule (uncomment to run) -->
<!-- <script src="seed.js"></script> -->
</body>
</html>
